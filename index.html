<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La AtmÃ³sfera - 1Âº ESO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            -webkit-font-smoothing: antialiased;
        }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .theory-content { white-space: pre-line; line-height: 1.8; }
        .theory-content strong { color: #1e40af; font-weight: 700; }
    </style>
</head>
<body>
    <div id="app"></div>
    <script>
        const blocks = {
            1: { title: "ORIGEN DE LA ATMÃ“SFERA", icon: "ğŸŒ‹", color: "from-orange-500 to-red-600" },
            2: { title: "COMPOSICIÃ“N DEL AIRE", icon: "ğŸ’¨", color: "from-blue-400 to-cyan-500" },
            3: { title: "CAPAS DE LA ATMÃ“SFERA", icon: "ğŸŒ", color: "from-indigo-500 to-purple-600" },
            4: { title: "FUNCIONES DE LA ATMÃ“SFERA", icon: "ğŸ›¡ï¸", color: "from-green-500 to-emerald-600" },
            5: { title: "CONTAMINACIÃ“N ATMOSFÃ‰RICA", icon: "ğŸ­", color: "from-gray-600 to-gray-800" }
        };

        const levelNames = {
            "1": { 
                "1.1": "Primera etapa - Origen volcÃ¡nico",
                "1.2": "Segunda etapa - FormaciÃ³n ocÃ©anos",
                "1.3": "Tercera etapa - ApariciÃ³n oxÃ­geno",
                "1.4": "Cuarta etapa - AtmÃ³sfera actual"
            },
            "2": { 
                "2.1": "NitrÃ³geno (78%)",
                "2.2": "OxÃ­geno (21%)",
                "2.3": "Otros gases",
                "2.4": "Aire y partÃ­culas"
            },
            "3": { 
                "3.1": "Troposfera",
                "3.2": "Estratosfera",
                "3.3": "Mesosfera",
                "3.4": "Termosfera y Exosfera"
            },
            "4": { 
                "4.1": "Efecto invernadero",
                "4.2": "Capa de ozono",
                "4.3": "ProtecciÃ³n meteoritos",
                "4.4": "FenÃ³menos meteorolÃ³gicos"
            },
            "5": { 
                "5.1": "Tipos de contaminantes",
                "5.2": "Lluvia Ã¡cida",
                "5.3": "Calentamiento global",
                "5.4": "Agujero de ozono"
            }
        };

        const theoryContent = {
            "1-1.1": {
                title: "PRIMERA ETAPA - Origen VolcÃ¡nico",
                content: `**Hace 4.400 millones de aÃ±os** se originÃ³ la atmÃ³sfera terrestre.

**Â¿CÃ³mo se formÃ³?**
- Los gases escaparon del interior de la Tierra (masa de roca fundida)
- La Tierra se enfriÃ³ y se liberaron gases volcÃ¡nicos
- Gases principales: diÃ³xido de carbono (COâ‚‚), monÃ³xido de carbono (CO), vapor de agua (Hâ‚‚O)

**CaracterÃ­stica importante:**
Esta atmÃ³sfera primitiva NO tenÃ­a oxÃ­geno, por lo que era irrespirable para los seres vivos actuales.`
            },
            "1-1.2": {
                title: "SEGUNDA ETAPA - FormaciÃ³n de OcÃ©anos",
                content: `**El vapor de agua se condensa**

Cuando la Tierra se enfriÃ³ lo suficiente:
- El vapor de agua comenzÃ³ a condensarse
- EmpezÃ³ a precipitar en forma de lluvias torrenciales
- Estas lluvias duraron millones de aÃ±os
- Se formaron los mares y ocÃ©anos (la hidrosfera)

**Resultado:** Gran parte del COâ‚‚ se disolviÃ³ en el agua de los ocÃ©anos.`
            },
            "1-1.3": {
                title: "TERCERA ETAPA - ApariciÃ³n del OxÃ­geno",
                content: `**Hace 3.500 millones de aÃ±os**

Aparecieron las primeras **cianobacterias** (bacterias fotosintÃ©ticas):
- Realizaban la fotosÃ­ntesis
- Liberaban oxÃ­geno (Oâ‚‚) a la atmÃ³sfera
- Gradualmente el oxÃ­geno se fue acumulando

**Con la apariciÃ³n de plantas y algas**, este proceso se acelerÃ³ enormemente.

**Importancia:** Por primera vez habÃ­a oxÃ­geno en la atmÃ³sfera.`
            },
            "1-1.4": {
                title: "CUARTA ETAPA - AtmÃ³sfera Actual",
                content: `**Finalmente pudieron aparecer los animales**

Con suficiente oxÃ­geno en la atmÃ³sfera:
- Los animales pudieron respirar
- Desde entonces la atmÃ³sfera ha mantenido una composiciÃ³n prÃ¡cticamente constante

**ComposiciÃ³n actual:**
- NitrÃ³geno (Nâ‚‚): 78%
- OxÃ­geno (Oâ‚‚): 21%
- Otros gases: 1% (COâ‚‚, argÃ³n, vapor de agua, ozono)`
            },
            "2-2.1": {
                title: "NITRÃ“GENO (Nâ‚‚) - 78%",
                content: `**El gas mÃ¡s abundante de la atmÃ³sfera**

**CaracterÃ­sticas:**
- Representa el 78% del aire
- Es un gas inerte (poco reactivo)
- SÃ­mbolo: Nâ‚‚

**Funciones:**
- Las plantas lo necesitan para formar proteÃ­nas
- Lo obtienen del suelo en forma de nitratos
- Es esencial para la vida aunque no lo respiramos directamente`
            },
            "2-2.2": {
                title: "OXÃGENO (Oâ‚‚) - 21%",
                content: `**El gas esencial para la respiraciÃ³n**

**CaracterÃ­sticas:**
- Representa el 21% del aire
- Es muy reactivo
- SÃ­mbolo: Oâ‚‚

**Funciones:**
- Necesario para la respiraciÃ³n de animales
- Permite las combustiones
- Se produce por la fotosÃ­ntesis de plantas y algas

**Importancia:** Sin oxÃ­geno no serÃ­a posible la vida animal en la Tierra.`
            },
            "2-2.3": {
                title: "OTROS GASES - 1%",
                content: `**Gases minoritarios pero importantes**

**ArgÃ³n (0,9%)**
- Gas noble, inerte

**DiÃ³xido de carbono - COâ‚‚ (0,04%)**
- Usado por las plantas en la fotosÃ­ntesis
- Gas de efecto invernadero

**Vapor de agua (cantidad variable)**
- Forma las nubes al condensarse
- Importante para el ciclo del agua

**Ozono (Oâ‚ƒ)**
- En la estratosfera
- Filtra rayos ultravioleta`
            },
            "2-2.4": {
                title: "AIRE Y PARTÃCULAS EN SUSPENSIÃ“N",
                content: `**Â¿QuÃ© es el aire?**
El aire es la mezcla de gases que respiramos (Nâ‚‚ + Oâ‚‚ + otros gases).

**PartÃ­culas en suspensiÃ³n:**
- Polvo
- Polen
- Humo
- Cenizas volcÃ¡nicas
- Cristales de sal marina

**CaracterÃ­sticas del aire:**
- Tiene masa y peso
- Es transparente e inodoro
- Puede moverse (viento)

**La atmÃ³sfera NO es homogÃ©nea:** tiene distintas capas con diferentes caracterÃ­sticas.`
            },
            "3-3.1": {
                title: "TROPOSFERA",
                content: `**La capa mÃ¡s cercana a la Tierra**

**CaracterÃ­sticas:**
- Altura: Desde la superficie hasta 12 km
- Temperatura: Disminuye con la altura (hasta -70Â°C en el lÃ­mite superior)
- Contiene el 80% de los gases de la atmÃ³sfera

**Funciones:**
- AquÃ­ ocurren todos los fenÃ³menos meteorolÃ³gicos: lluvias, tormentas, tornados
- Es crucial para la vida en la Tierra
- Ãšnica capa en contacto directo con la superficie

**Curiosidades:**
- Los aviones comerciales vuelan en la parte alta de la troposfera para evitar turbulencias`
            },
            "3-3.2": {
                title: "ESTRATOSFERA",
                content: `**La capa del ozono**

**CaracterÃ­sticas:**
- Altura: Entre 12 y 50 km
- Temperatura: Aumenta con la altitud (hasta 0Â°C)
- El aumento se debe a la absorciÃ³n de radiaciÃ³n ultravioleta

**Funciones:**
- Alberga la **capa de ozono**
- Bloquea los daÃ±inos rayos ultravioleta del Sol

**Curiosidades:**
- Los aviones espÃ­a U-2 vuelan aquÃ­
- Los saltos estratosfÃ©ricos en paracaÃ­das ocurren en esta capa
- AquÃ­ se encuentran los globos meteorolÃ³gicos`
            },
            "3-3.3": {
                title: "MESOSFERA",
                content: `**La capa mÃ¡s frÃ­a**

**CaracterÃ­sticas:**
- Altura: Entre 50 y 80 km
- Temperatura: La mÃ¡s frÃ­a de la atmÃ³sfera (hasta -100Â°C)

**Funciones:**
- ActÃºa como escudo protector
- Desintegra la mayorÃ­a de los meteoritos
- Da lugar a las estrellas fugaces

**Curiosidades:**
- Es la capa menos estudiada
- No hay globos ni aviones que puedan llegar
- Conocida como el "cementerio de meteoritos"`
            },
            "3-3.4": {
                title: "TERMOSFERA Y EXOSFERA",
                content: `**TERMOSFERA (80-500 km)**

**CaracterÃ­sticas:**
- Temperaturas extremadamente altas (>1.500Â°C)
- Calentamiento por rayos solares
- Se producen las auroras boreales

**Funciones:**
- Orbitan la mayorÃ­a de satÃ©lites artificiales
- Incluye la EstaciÃ³n Espacial Internacional

---

**EXOSFERA (600-10.000 km)**

**CaracterÃ­sticas:**
- La capa mÃ¡s externa
- ComposiciÃ³n igual al espacio interplanetario

**Funciones:**
- Zona de transiciÃ³n atmÃ³sfera-espacio exterior
- SatÃ©lites geoestacionarios`
            },
            "4-4.1": {
                title: "EFECTO INVERNADERO",
                content: `**Un fenÃ³meno natural necesario**

**Â¿QuÃ© es?**
Algunos gases (COâ‚‚, vapor de agua) retienen el calor del Sol, manteniendo la Tierra caliente.

**Â¿Por quÃ© es importante?**
- Sin efecto invernadero: -18Â°C (vida imposible)
- Con efecto invernadero: +15Â°C (temperatura media actual)

**El problema:**
El exceso de COâ‚‚ por actividades humanas aumenta demasiado la temperatura (calentamiento global).

**Causas del exceso:**
- Quema de combustibles fÃ³siles (petrÃ³leo, carbÃ³n, gas)
- DeforestaciÃ³n
- Industrias contaminantes`
            },
            "4-4.2": {
                title: "CAPA DE OZONO",
                content: `**El escudo protector**

**Â¿QuÃ© es?**
Capa de ozono (Oâ‚ƒ) en la estratosfera que filtra los rayos ultravioleta del Sol.

**Funciones:**
- Bloquea el 99% de los rayos UV
- Protege a los seres vivos

**DaÃ±os que causan los rayos UV:**
- CÃ¡ncer de piel
- Quemaduras solares
- DaÃ±o ocular (cataratas)
- DaÃ±o al ADN

**Amenaza:**
Los CFC (clorofluorocarbonos) de aerosoles y refrigeradores antiguos destruyen el ozono.

**Agujero de ozono:** Principalmente sobre la AntÃ¡rtida.`
            },
            "4-4.3": {
                title: "PROTECCIÃ“N CONTRA METEORITOS",
                content: `**La atmÃ³sfera como escudo**

**Â¿CÃ³mo protege?**
- Los meteoritos entran a gran velocidad
- La fricciÃ³n con el aire los calienta
- Se desintegran en la mesosfera
- Los vemos como "estrellas fugaces"

**Resultado:**
La mayorÃ­a de meteoritos NO llegan al suelo.

**Sin atmÃ³sfera:**
Como en la Luna, todos los meteoritos impactarÃ­an la superficie creando crÃ¡teres.

**Importancia:**
Protege la vida en la Tierra de impactos constantes desde el espacio.`
            },
            "4-4.4": {
                title: "FENÃ“MENOS METEOROLÃ“GICOS",
                content: `**La atmÃ³sfera regula el clima**

**Funciones:**
- **Ciclo del agua:** EvaporaciÃ³n â†’ nubes â†’ lluvia
- **Viento:** Movimiento del aire
- **Tormentas:** Descargas elÃ©ctricas
- **Temperatura:** Regula el calor

**Importancia del agua:**
- Las lluvias traen agua dulce
- Necesaria para la vida
- Rellena rÃ­os, lagos y acuÃ­feros

**FenÃ³menos:**
- Lluvia, nieve, granizo
- Tornados y huracanes
- ArcoÃ­ris
- RelÃ¡mpagos`
            },
            "5-5.1": {
                title: "TIPOS DE CONTAMINANTES",
                content: `**Â¿QuÃ© es la contaminaciÃ³n atmosfÃ©rica?**
Presencia de sustancias o energÃ­a que causan efectos nocivos para los seres vivos.

**Principales contaminantes:**

**1. Gases:**
- COâ‚‚ (diÃ³xido de carbono)
- SOâ‚‚ (Ã³xido de azufre)
- NOâ‚“ (Ã³xidos de nitrÃ³geno)
- CFCs (clorofluorocarbonos)

**2. PartÃ­culas sÃ³lidas:**
- Humo
- HollÃ­n
- Polvo industrial

**3. Ruido:**
- ContaminaciÃ³n acÃºstica`
            },
            "5-5.2": {
                title: "LLUVIA ÃCIDA",
                content: `**Â¿QuÃ© es?**
Lluvia con pH bajo (Ã¡cido) causada por contaminantes.

**Causas:**
- SOâ‚‚ y NOâ‚“ de fÃ¡bricas y vehÃ­culos
- Se combinan con agua en la atmÃ³sfera
- Forman Ã¡cido sulfÃºrico y Ã¡cido nÃ­trico

**Efectos:**
- DaÃ±a bosques y cultivos
- Acidifica lagos y rÃ­os (mata peces)
- Corroe edificios y estatuas
- DaÃ±a la salud humana

**SoluciÃ³n:**
Reducir emisiones de SOâ‚‚ y NOâ‚“ usando filtros en industrias y vehÃ­culos menos contaminantes.`
            },
            "5-5.3": {
                title: "CALENTAMIENTO GLOBAL",
                content: `**Aumento de la temperatura media del planeta**

**Causa:**
Exceso de gases de efecto invernadero (principalmente COâ‚‚) por actividades humanas.

**Consecuencias:**
- Deshielo de polos y glaciares
- Aumento del nivel del mar
- Cambios en el clima
- SequÃ­as e inundaciones
- ExtinciÃ³n de especies

**Soluciones:**
- EnergÃ­as renovables (solar, eÃ³lica)
- Reducir uso de combustibles fÃ³siles
- ReforestaciÃ³n
- Transporte sostenible`
            },
            "5-5.4": {
                title: "AGUJERO DE OZONO",
                content: `**ReducciÃ³n de la capa de ozono**

**Causa:**
Los CFCs (en aerosoles, refrigeradores antiguos) destruyen las molÃ©culas de ozono.

**UbicaciÃ³n:**
Principalmente sobre la AntÃ¡rtida (polo sur).

**Consecuencias:**
- MÃ¡s rayos UV llegan a la Tierra
- Aumento de cÃ¡ncer de piel
- DaÃ±o a ecosistemas

**SoluciÃ³n:**
- Protocolo de Montreal (1987)
- ProhibiciÃ³n de CFCs
- Uso de gases alternativos

**Buenas noticias:**
El agujero se estÃ¡ recuperando lentamente.`
            }
        };

        const exerciseData = {
            "1-1.1": [
                { q: "Â¿Hace cuÃ¡ntos millones de aÃ±os se originÃ³ la atmÃ³sfera?", a: "4400", sol: "4.400 millones de aÃ±os" },
                { q: "Â¿De dÃ³nde salieron los gases?", a: "interior tierra volcanes", sol: "Del interior de la Tierra (volcanes)" },
                { q: "Â¿HabÃ­a oxÃ­geno en la atmÃ³sfera primitiva? (sÃ­/no)", a: "no", sol: "NO habÃ­a oxÃ­geno" },
                { q: "Â¿QuÃ© gas abundaba?", a: "dioxido carbono co2", sol: "DiÃ³xido de carbono (COâ‚‚)" }
            ],
            "1-1.2": [
                { q: "Â¿QuÃ© ocurriÃ³ cuando la Tierra se enfriÃ³?", a: "vapor agua condenso lluvia", sol: "El vapor de agua se condensÃ³ y lloviÃ³" },
                { q: "Â¿QuÃ© se formÃ³ con las lluvias?", a: "oceanos mares hidrosfera", sol: "Los ocÃ©anos y mares (hidrosfera)" },
                { q: "Â¿DÃ³nde se disolviÃ³ parte del COâ‚‚?", a: "agua oceanos mares", sol: "En el agua de los ocÃ©anos" }
            ],
            "1-1.3": [
                { q: "Â¿Hace cuÃ¡ntos millones de aÃ±os aparecieron las primeras bacterias fotosintÃ©ticas?", a: "3500", sol: "3.500 millones de aÃ±os" },
                { q: "Â¿CÃ³mo se llaman esas bacterias?", a: "cianobacterias", sol: "Cianobacterias" },
                { q: "Â¿QuÃ© gas producÃ­an?", a: "oxigeno o2", sol: "OxÃ­geno (Oâ‚‚)" },
                { q: "Â¿QuÃ© seres vivos tambiÃ©n producen oxÃ­geno?", a: "plantas algas", sol: "Plantas y algas" }
            ],
            "1-1.4": [
                { q: "Â¿QuÃ© porcentaje de nitrÃ³geno tiene el aire actual?", a: "78", sol: "78%" },
                { q: "Â¿QuÃ© porcentaje de oxÃ­geno?", a: "21", sol: "21%" },
                { q: "Â¿QuÃ© porcentaje representan los demÃ¡s gases?", a: "1", sol: "1%" },
                { q: "Â¿Por quÃ© pudieron aparecer los animales?", a: "oxigeno respirar", sol: "Porque habÃ­a oxÃ­geno para respirar" }
            ],
            "2-2.1": [
                { q: "Â¿QuÃ© porcentaje del aire es nitrÃ³geno?", a: "78", sol: "78%" },
                { q: "Â¿CuÃ¡l es su sÃ­mbolo quÃ­mico?", a: "n2", sol: "Nâ‚‚" },
                { q: "Â¿Es reactivo o inerte?", a: "inerte", sol: "Inerte (poco reactivo)" },
                { q: "Â¿Para quÃ© lo necesitan las plantas?", a: "proteinas", sol: "Para formar proteÃ­nas" }
            ],
            "2-2.2": [
                { q: "Â¿QuÃ© porcentaje del aire es oxÃ­geno?", a: "21", sol: "21%" },
                { q: "Â¿CuÃ¡l es su sÃ­mbolo quÃ­mico?", a: "o2", sol: "Oâ‚‚" },
                { q: "Â¿Para quÃ© lo usamos?", a: "respirar", sol: "Para respirar" },
                { q: "Â¿QuÃ© proceso lo produce?", a: "fotosintesis", sol: "La fotosÃ­ntesis" }
            ],
            "2-2.3": [
                { q: "Â¿QuÃ© gas noble hay en el aire?", a: "argon", sol: "ArgÃ³n" },
                { q: "Â¿QuÃ© porcentaje de COâ‚‚ hay?", a: "0.04", sol: "0,04%" },
                { q: "Â¿Para quÃ© usan las plantas el COâ‚‚?", a: "fotosintesis", sol: "Para la fotosÃ­ntesis" },
                { q: "Â¿QuÃ© forma el vapor de agua al condensarse?", a: "nubes", sol: "Las nubes" }
            ],
            "2-2.4": [
                { q: "Â¿CÃ³mo se llama la mezcla de gases que respiramos?", a: "aire", sol: "Aire" },
                { q: "Â¿El aire tiene masa? (sÃ­/no)", a: "si", sol: "SÃ­" },
                { q: "Â¿La atmÃ³sfera es homogÃ©nea? (sÃ­/no)", a: "no", sol: "NO, tiene distintas capas" },
                { q: "Nombra 2 partÃ­culas en suspensiÃ³n", a: "polvo polen humo", sol: "Polvo, polen, humo, cenizas..." }
            ],
            "3-3.1": [
                { q: "Â¿Hasta quÃ© altura llega la troposfera?", a: "12", sol: "12 km" },
                { q: "Â¿QuÃ© porcentaje del aire contiene?", a: "80", sol: "80%" },
                { q: "Â¿La temperatura aumenta o disminuye con la altura?", a: "disminuye", sol: "Disminuye" },
                { q: "Â¿QuÃ© ocurre en esta capa?", a: "fenomenos meteorologicos lluvia", sol: "FenÃ³menos meteorolÃ³gicos (lluvia, tormentas...)" },
                { q: "Â¿DÃ³nde vuelan los aviones comerciales?", a: "troposfera", sol: "En la troposfera" }
            ],
            "3-3.2": [
                { q: "Â¿Entre quÃ© alturas estÃ¡ la estratosfera?", a: "12 50", sol: "Entre 12 y 50 km" },
                { q: "Â¿La temperatura aumenta o disminuye?", a: "aumenta", sol: "Aumenta con la altura" },
                { q: "Â¿QuÃ© capa importante hay aquÃ­?", a: "ozono", sol: "La capa de ozono" },
                { q: "Â¿QuÃ© radiaciÃ³n bloquea el ozono?", a: "ultravioleta uv", sol: "RadiaciÃ³n ultravioleta (UV)" },
                { q: "Â¿Hasta quÃ© temperatura puede llegar?", a: "0", sol: "0Â°C" }
            ],
            "3-3.3": [
                { q: "Â¿Entre quÃ© alturas estÃ¡ la mesosfera?", a: "50 80", sol: "Entre 50 y 80 km" },
                { q: "Â¿Es la capa mÃ¡s frÃ­a o mÃ¡s caliente?", a: "fria", sol: "La mÃ¡s frÃ­a" },
                { q: "Â¿QuÃ© temperatura mÃ­nima alcanza?", a: "-100", sol: "-100Â°C" },
                { q: "Â¿QuÃ© se desintegra aquÃ­?", a: "meteoritos", sol: "Los meteoritos" },
                { q: "Â¿CÃ³mo se llaman las 'estrellas fugaces'?", a: "meteoritos", sol: "Meteoritos que se desintegran" }
            ],
            "3-3.4": [
                { q: "Â¿Entre quÃ© alturas estÃ¡ la termosfera?", a: "80 500", sol: "Entre 80 y 500 km" },
                { q: "Â¿QuÃ© temperatura puede alcanzar?", a: "1500", sol: "MÃ¡s de 1.500Â°C" },
                { q: "Â¿QuÃ© fenÃ³meno luminoso ocurre aquÃ­?", a: "auroras boreales", sol: "Auroras boreales" },
                { q: "Â¿CuÃ¡l es la capa mÃ¡s externa?", a: "exosfera", sol: "La exosfera" },
                { q: "Â¿DÃ³nde estÃ¡n los satÃ©lites geoestacionarios?", a: "exosfera", sol: "En la exosfera" }
            ],
            "4-4.1": [
                { q: "Â¿QuÃ© gases causan el efecto invernadero?", a: "co2 vapor agua", sol: "COâ‚‚ y vapor de agua" },
                { q: "Â¿Es necesario el efecto invernadero? (sÃ­/no)", a: "si", sol: "SÃ­, mantiene la temperatura" },
                { q: "Â¿QuÃ© temperatura habrÃ­a sin Ã©l?", a: "-18", sol: "-18Â°C" },
                { q: "Â¿QuÃ© causa el exceso de COâ‚‚?", a: "combustibles fosiles", sol: "Quema de combustibles fÃ³siles" }
            ],
            "4-4.2": [
                { q: "Â¿En quÃ© capa estÃ¡ la capa de ozono?", a: "estratosfera", sol: "En la estratosfera" },
                { q: "Â¿QuÃ© radiaciÃ³n filtra?", a: "ultravioleta uv", sol: "Rayos ultravioleta (UV)" },
                { q: "Nombra un daÃ±o que causan los rayos UV", a: "cancer piel quemaduras", sol: "CÃ¡ncer de piel, quemaduras..." },
                { q: "Â¿QuÃ© sustancias daÃ±an el ozono?", a: "cfc", sol: "Los CFC (clorofluorocarbonos)" }
            ],
            "4-4.3": [
                { q: "Â¿En quÃ© capa se desintegran los meteoritos?", a: "mesosfera", sol: "En la mesosfera" },
                { q: "Â¿Por quÃ© se desintegran?", a: "friccion aire calor", sol: "Por la fricciÃ³n con el aire" },
                { q: "Â¿CÃ³mo los vemos desde la Tierra?", a: "estrellas fugaces", sol: "Como estrellas fugaces" },
                { q: "Â¿Todos llegan al suelo? (sÃ­/no)", a: "no", sol: "NO, la mayorÃ­a se desintegran" }
            ],
            "4-4.4": [
                { q: "Â¿DÃ³nde ocurren las lluvias y tormentas?", a: "troposfera", sol: "En la troposfera" },
                { q: "Nombra 3 fenÃ³menos meteorolÃ³gicos", a: "lluvia viento tormenta", sol: "Lluvia, viento, tormenta, nieve..." },
                { q: "Â¿Para quÃ© es necesaria el agua de lluvia?", a: "vida dulce rios", sol: "Para la vida, rÃ­os, lagos..." },
                { q: "Â¿QuÃ© ciclo implica evaporaciÃ³n y lluvia?", a: "agua", sol: "El ciclo del agua" }
            ],
            "5-5.1": [
                { q: "Â¿QuÃ© es la contaminaciÃ³n atmosfÃ©rica?", a: "sustancias nocivas", sol: "Presencia de sustancias nocivas" },
                { q: "Nombra 2 gases contaminantes", a: "co2 so2 nox cfc", sol: "COâ‚‚, SOâ‚‚, NOâ‚“, CFCs..." },
                { q: "Â¿Las partÃ­culas sÃ³lidas contaminan? (sÃ­/no)", a: "si", sol: "SÃ­ (humo, hollÃ­n, polvo...)" },
                { q: "Â¿El ruido es contaminaciÃ³n? (sÃ­/no)", a: "si", sol: "SÃ­, contaminaciÃ³n acÃºstica" }
            ],
            "5-5.2": [
                { q: "Â¿QuÃ© es la lluvia Ã¡cida?", a: "lluvia acida ph bajo", sol: "Lluvia con pH bajo (Ã¡cida)" },
                { q: "Â¿QuÃ© gases la causan?", a: "so2 nox", sol: "SOâ‚‚ y NOâ‚“" },
                { q: "Â¿De dÃ³nde vienen esos gases?", a: "fabricas vehiculos industria", sol: "FÃ¡bricas y vehÃ­culos" },
                { q: "Nombra un efecto de la lluvia Ã¡cida", a: "daÃ±a bosques rios corroe", sol: "DaÃ±a bosques, rÃ­os, edificios..." }
            ],
            "5-5.3": [
                { q: "Â¿QuÃ© es el calentamiento global?", a: "aumento temperatura", sol: "Aumento de la temperatura del planeta" },
                { q: "Â¿QuÃ© gas lo causa principalmente?", a: "co2", sol: "COâ‚‚ (diÃ³xido de carbono)" },
                { q: "Nombra una consecuencia", a: "deshielo nivel mar cambio clima", sol: "Deshielo, subida del nivel del mar, cambios climÃ¡ticos..." },
                { q: "Â¿QuÃ© energÃ­as ayudan a reducirlo?", a: "renovables solar eolica", sol: "EnergÃ­as renovables (solar, eÃ³lica...)" }
            ],
            "5-5.4": [
                { q: "Â¿QuÃ© es el agujero de ozono?", a: "reduccion ozono", sol: "ReducciÃ³n de la capa de ozono" },
                { q: "Â¿QuÃ© sustancias lo causan?", a: "cfc", sol: "Los CFCs" },
                { q: "Â¿DÃ³nde estÃ¡ principalmente?", a: "antartida polo sur", sol: "Sobre la AntÃ¡rtida" },
                { q: "Â¿QuÃ© acuerdo lo prohibiÃ³?", a: "montreal", sol: "Protocolo de Montreal (1987)" },
                { q: "Â¿Se estÃ¡ recuperando? (sÃ­/no)", a: "si", sol: "SÃ­, lentamente" }
            ]
        };

        let state = {
            selectedBlock: null,
            selectedLevel: null,
            showTheory: true,
            answers: {},
            showResults: {},
            studentName: localStorage.getItem('studentName') || '',
            showNameModal: !localStorage.getItem('studentName')
        };

        function saveState() {
            localStorage.setItem('studentName', state.studentName);
        }

        function render() {
            const app = document.getElementById('app');
            let html = '';

            if (state.showNameModal && !state.studentName) {
                html += `<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">Â¡Bienvenido/a!</h2>
                        <p class="text-gray-600 mb-6">Por favor, introduce tu nombre para comenzar:</p>
                        <input type="text" id="nameInput" placeholder="Tu nombre completo" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none mb-4">
                        <button onclick="setName()" class="w-full px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition font-medium">
                            Comenzar
                        </button>
                    </div>
                </div>`;
            }

            html += `<div class="min-h-screen bg-gradient-to-br from-sky-100 via-blue-50 to-indigo-100 p-4">
                <div class="max-w-7xl mx-auto">
                    <div class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl shadow-2xl p-8 mb-8 text-white relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-64 h-64 bg-white opacity-10 rounded-full -mr-32 -mt-32"></div>
                        <div class="relative z-10">
                            <div class="flex items-center gap-4 mb-4">
                                <div class="bg-white p-4 rounded-xl">
                                    <svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                                </div>
                                <div>
                                    <h1 class="text-4xl font-bold mb-2">La AtmÃ³sfera</h1>
                                    <p class="text-blue-100 text-lg">BiologÃ­a y GeologÃ­a - 1Âº ESO ğŸŒ</p>
                                    ${state.studentName ? `<p class="text-blue-200 text-sm mt-1">ğŸ‘¤ ${state.studentName}</p>` : ''}
                                </div>
                            </div>
                            <div class="flex gap-4 mt-6 flex-wrap">
                                <div class="bg-white bg-opacity-20 px-4 py-2 rounded-lg backdrop-blur">
                                    <span class="font-semibold">ğŸ¯ 5 Bloques TemÃ¡ticos</span>
                                </div>
                                <div class="bg-white bg-opacity-20 px-4 py-2 rounded-lg backdrop-blur">
                                    <span class="font-semibold">ğŸ“š 20 Niveles</span>
                                </div>
                                <div class="bg-white bg-opacity-20 px-4 py-2 rounded-lg backdrop-blur">
                                    <span class="font-semibold">ğŸ“– TeorÃ­a + PrÃ¡ctica</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    ${!state.selectedBlock ? renderBlockSelection() : (!state.selectedLevel ? renderLevelSelection() : (state.showTheory ? renderTheory() : renderExercises()))}
                </div>
            </div>`;

            app.innerHTML = html;
        }

        function renderBlockSelection() {
            return `<div>
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span class="text-3xl">ğŸ†</span> Selecciona un Bloque TemÃ¡tico
                </h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    ${Object.entries(blocks).map(([id, block]) => `
                        <div onclick="selectBlock('${id}')" class="bg-gradient-to-br ${block.color} rounded-2xl shadow-xl p-6 cursor-pointer transform transition-all hover:scale-105 text-white">
                            <div class="text-5xl mb-4">${block.icon}</div>
                            <h3 class="font-bold text-xl mb-3">${block.title}</h3>
                            <div class="flex items-center text-white font-medium">
                                Comenzar <span class="ml-2">â†’</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>`;
        }

        function renderLevelSelection() {
            const block = blocks[state.selectedBlock];
            return `<div>
                <button onclick="backToBlocks()" class="mb-6 px-6 py-3 bg-white rounded-xl hover:bg-gray-50 transition shadow-lg flex items-center gap-2">
                    <span>â†</span> Volver a Bloques
                </button>
                
                <div class="bg-gradient-to-r ${block.color} rounded-2xl shadow-xl p-8 mb-8 text-white">
                    <h2 class="text-3xl font-bold">${block.title}</h2>
                </div>

                <div class="grid md:grid-cols-2 gap-6">
                    ${Object.entries(levelNames[state.selectedBlock] || {}).map(([levelId, levelName]) => `
                        <div onclick="selectLevel('${levelId}')" class="bg-white rounded-xl shadow-lg p-6 cursor-pointer hover:shadow-2xl transition-all">
                            <span class="bg-green-500 text-white px-4 py-1 rounded-full text-sm font-bold">
                                Nivel ${levelId}
                            </span>
                            <h3 class="font-bold text-xl text-gray-800 mt-3">${levelName}</h3>
                            <div class="flex items-center text-blue-600 font-medium mt-3">
                                <span class="mr-2">ğŸ“–</span> Leer teorÃ­a
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>`;
        }

        function renderTheory() {
            const levelKey = `${state.selectedBlock}-${state.selectedLevel}`;
            const theory = theoryContent[levelKey];
            
            return `<div>
                <div class="flex gap-2 mb-6">
                    <button onclick="backToLevels()" class="px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-50 transition">
                        <span>â†</span> Niveles
                    </button>
                    <button onclick="backToBlocks()" class="px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-50 transition">
                        <span>ğŸ </span> Inicio
                    </button>
                </div>

                <div class="bg-white rounded-2xl shadow-xl p-8 mb-6">
                    <div class="flex items-center gap-3 mb-6">
                        <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                        <h2 class="text-3xl font-bold text-blue-900">${theory.title}</h2>
                    </div>
                    
                    <div class="theory-content text-gray-700 text-lg leading-relaxed">${theory.content}</div>

                    <button onclick="showExercises()" class="mt-8 w-full px-8 py-4 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-xl hover:from-green-700 hover:to-emerald-700 transition font-bold text-lg shadow-lg">
                        âœ… He leÃ­do la teorÃ­a - Hacer Ejercicios
                    </button>
                </div>
            </div>`;
        }

        function renderExercises() {
            const levelKey = `${state.selectedBlock}-${state.selectedLevel}`;
            const exercises = exerciseData[levelKey] || [];
            
            return `<div>
                <div class="flex gap-2 mb-6 flex-wrap">
                    <button onclick="showTheoryAgain()" class="px-4 py-2 bg-blue-100 text-blue-700 rounded-lg shadow hover:bg-blue-200 transition">
                        <span class="mr-2">ğŸ“–</span> Ver TeorÃ­a
                    </button>
                    <button onclick="backToLevels()" class="px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-50 transition">
                        <span>â†</span> Niveles
                    </button>
                    <button onclick="backToBlocks()" class="px-4 py-2 bg-white rounded-lg shadow hover:bg-gray-50 transition">
                        <span>ğŸ </span> Inicio
                    </button>
                </div>

                <div class="bg-white rounded-2xl shadow-xl p-6 mb-6">
                    <h2 class="text-2xl font-bold text-indigo-900">
                        Ejercicios - Nivel ${state.selectedLevel}: ${levelNames[state.selectedBlock]?.[state.selectedLevel]}
                    </h2>
                    <p class="text-gray-600 mt-2">Responde las preguntas sobre la teorÃ­a que acabas de leer</p>
                </div>

                <div class="space-y-6">
                    ${exercises.map((ex, idx) => {
                        const key = `${levelKey}-${idx}`;
                        const result = state.showResults[key];
                        return `
                            <div class="bg-white border-2 rounded-xl p-6">
                                <div class="flex items-start gap-4">
                                    <span class="bg-indigo-100 text-indigo-800 px-4 py-2 rounded-full font-bold">
                                        #${idx + 1}
                                    </span>
                                    <div class="flex-1">
                                        <div class="text-xl font-medium mb-4">${ex.q}</div>
                                        <div class="flex gap-2">
                                            <input
                                                type="text"
                                                id="answer-${key}"
                                                value="${state.answers[key] || ''}"
                                                oninput="updateAnswer('${key}', this.value)"
                                                placeholder="Tu respuesta"
                                                class="flex-1 px-4 py-3 border-2 rounded-lg focus:border-indigo-500 outline-none"
                                            />
                                            <button onclick="checkAnswer('${key}', '${ex.a}')" class="px-8 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition">
                                                Comprobar
                                            </button>
                                        </div>

                                        ${result !== undefined ? `
                                            <div class="mt-4 p-4 rounded-lg ${result ? 'bg-green-50 border-2 border-green-300' : 'bg-red-50 border-2 border-red-300'}">
                                                <div class="flex items-center gap-2">
                                                    ${result ? `
                                                        <span class="text-2xl">âœ…</span>
                                                        <span class="font-bold text-green-800">Â¡Correcto! ğŸ‰</span>
                                                    ` : `
                                                        <span class="text-2xl">âŒ</span>
                                                        <span class="font-bold text-red-800">Incorrecto</span>
                                                    `}
                                                </div>
                                                <div class="text-gray-700 mt-2">
                                                    <strong>SoluciÃ³n:</strong> ${ex.sol}
                                                </div>
                                            </div>
                                        ` : ''}
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            </div>`;
        }

        function setName() {
            const input = document.getElementById('nameInput');
            if (input && input.value.trim()) {
                state.studentName = input.value.trim();
                state.showNameModal = false;
                saveState();
                render();
            }
        }

        function selectBlock(id) {
            state.selectedBlock = id;
            state.selectedLevel = null;
            state.showTheory = true;
            render();
        }

        function selectLevel(id) {
            state.selectedLevel = id;
            state.showTheory = true;
            render();
        }

        function backToBlocks() {
            state.selectedBlock = null;
            state.selectedLevel = null;
            render();
        }

        function backToLevels() {
            state.selectedLevel = null;
            render();
        }

        function showExercises() {
            state.showTheory = false;
            render();
        }

        function showTheoryAgain() {
            state.showTheory = true;
            render();
        }

        function updateAnswer(key, value) {
            state.answers[key] = value;
        }

        function checkAnswer(key, correct) {
            const userAnswer = (state.answers[key] || '').trim().toLowerCase().replace(/\s+/g, ' ');
            const correctAnswers = correct.toLowerCase().split(' ');
            const isCorrect = correctAnswers.some(ans => userAnswer.includes(ans.replace(/\s/g, '')));
            
            state.showResults[key] = isCorrect;
            render();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            render();
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && document.getElementById('nameInput')) {
                    setName();
                }
            });
        });
    </script>
</body>
</html>