<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Atm√≥sfera - 1¬∫ ESO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .word-reveal {
            animation: wordReveal 0.8s ease-out;
        }
        @keyframes wordReveal {
            0% { opacity: 0; transform: scale(0.5) rotate(-10deg); }
            50% { transform: scale(1.2) rotate(5deg); }
            100% { opacity: 1; transform: scale(1) rotate(0deg); }
        }
        .secret-word {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px 30px;
            border-radius: 15px;
            font-size: 2rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            display: inline-block;
            margin: 20px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        .block-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        .level-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="app"></div>
    <script>
        const blocks = {
            1: { 
                title: "ORIGEN DE LA ATM√ìSFERA", 
                icon: "üåã", 
                color: "from-orange-500 to-red-600", 
                desc: "Las 4 etapas evolutivas",
                image: "imagenes/volcan-primitivo.jpg"
            },
            2: { 
                title: "COMPOSICI√ìN DEL AIRE", 
                icon: "üí®", 
                color: "from-blue-400 to-cyan-500", 
                desc: "Gases y porcentajes",
                image: "imagenes/composicion-aire.png"
            },
            3: { 
                title: "CAPAS DE LA ATM√ìSFERA", 
                icon: "üåç", 
                color: "from-indigo-500 to-purple-600", 
                desc: "Troposfera, estratosfera...",
                image: "imagenes/capas-atmosfera.jpg"
            },
            4: { 
                title: "FUNCIONES DE LA ATM√ìSFERA", 
                icon: "üõ°Ô∏è", 
                color: "from-green-500 to-emerald-600", 
                desc: "Protecci√≥n y vida",
                image: "imagenes/efecto-invernadero.jpg"
            },
            5: { 
                title: "CONTAMINACI√ìN ATMOSF√âRICA", 
                icon: "üè≠", 
                color: "from-gray-600 to-gray-800", 
                desc: "Causas y efectos",
                image: "imagenes/contaminacion-ciudad.jpg"
            },
            6: { 
                title: "EFECTO INVERNADERO Y OZONO", 
                icon: "‚òÄÔ∏è", 
                color: "from-yellow-500 to-orange-500", 
                desc: "Fen√≥menos especiales",
                image: "imagenes/calentamiento-global.jpg"
            }
        };

        const levelNames = {
            "1": { 
                "1.1": "Primera etapa - Origen volc√°nico", 
                "1.2": "Segunda etapa - Formaci√≥n oc√©anos", 
                "1.3": "Tercera etapa - Aparici√≥n fotos√≠ntesis", 
                "1.4": "Cuarta etapa - Atm√≥sfera actual" 
            },
            "2": { 
                "2.1": "Nitr√≥geno y ox√≠geno", 
                "2.2": "Gases minoritarios", 
                "2.3": "Vapor de agua y part√≠culas", 
                "2.4": "Composici√≥n completa" 
            },
            "3": { 
                "3.1": "Troposfera", 
                "3.2": "Estratosfera y capa de ozono", 
                "3.3": "Mesosfera y termosfera", 
                "3.4": "Exosfera y caracter√≠sticas generales" 
            },
            "4": { 
                "4.1": "Regulaci√≥n t√©rmica", 
                "4.2": "Protecci√≥n contra radiaciones", 
                "4.3": "Gases esenciales para la vida", 
                "4.4": "Fen√≥menos meteorol√≥gicos" 
            },
            "5": { 
                "5.1": "Tipos de contaminantes", 
                "5.2": "Lluvia √°cida", 
                "5.3": "Smog y calidad del aire", 
                "5.4": "Soluciones y prevenci√≥n" 
            },
            "6": { 
                "6.1": "Efecto invernadero natural", 
                "6.2": "Calentamiento global", 
                "6.3": "Capa de ozono", 
                "6.4": "Agujero de ozono y CFCs" 
            }
        };

        const levelImages = {
            "1-1.1": "imagenes/volcan-primitivo.jpg",
            "1-1.2": "imagenes/oceano-lluvia.jpg",
            "1-1.3": "imagenes/cianobacterias.jpg",
            "1-1.4": "imagenes/atmosfera-actual.jpg",
            "2-2.1": "imagenes/composicion-aire.png",
            "2-2.2": "imagenes/composicion-aire.png",
            "2-2.3": "imagenes/composicion-aire.png",
            "2-2.4": "imagenes/composicion-aire.png",
            "3-3.1": "imagenes/troposfera.jpg",
            "3-3.2": "imagenes/estratosfera-ozono.jpg",
            "3-3.3": "imagenes/meteorito.jpg",
            "3-3.4": "imagenes/capas-atmosfera.jpg",
            "4-4.1": "imagenes/efecto-invernadero.jpg",
            "4-4.2": "imagenes/proteccion-uv.jpg",
            "4-4.3": "imagenes/atmosfera-actual.jpg",
            "4-4.4": "imagenes/troposfera.jpg",
            "5-5.1": "imagenes/contaminacion-ciudad.jpg",
            "5-5.2": "imagenes/lluvia-acida.jpg",
            "5-5.3": "imagenes/contaminacion-ciudad.jpg",
            "5-5.4": "imagenes/contaminacion-ciudad.jpg",
            "6-6.1": "imagenes/efecto-invernadero.jpg",
            "6-6.2": "imagenes/calentamiento-global.jpg",
            "6-6.3": "imagenes/estratosfera-ozono.jpg",
            "6-6.4": "imagenes/agujero-ozono.jpg"
        };

        const secretWords = {
            "1-1.1": "LA",
            "1-1.2": "ATM√ìSFERA",
            "1-1.3": "PROTEGE",
            "1-1.4": "LA",
            "2-2.1": "VIDA",
            "2-2.2": "EN",
            "2-2.3": "LA",
            "2-2.4": "TIERRA",
            "3-3.1": "GRACIAS",
            "3-3.2": "AL",
            "3-3.3": "OX√çGENO",
            "3-3.4": "Y",
            "4-4.1": "LA",
            "4-4.2": "CAPA",
            "4-4.3": "DE",
            "4-4.4": "OZONO",
            "5-5.1": "QUE",
            "5-5.2": "DEBEMOS",
            "5-5.3": "PROTEGER",
            "5-5.4": "SIEMPRE",
            "6-6.1": "PARA",
            "6-6.2": "NUESTRO",
            "6-6.3": "FUTURO",
            "6-6.4": "SOSTENIBLE"
        };

        const exerciseData = {
            "1-1.1": [
                { q: "¬øHace cu√°ntos millones de a√±os se origin√≥ la atm√≥sfera?", a: "4400", sol: "La atm√≥sfera se origin√≥ hace 4400 millones de a√±os" },
                { q: "¬øDe d√≥nde proced√≠an los gases de la primera atm√≥sfera?", a: "interior tierra", sol: "Los gases escaparon del interior de la Tierra (masa de roca fundida)" },
                { q: "¬øQu√© tipo de actividad geol√≥gica era frecuente en esta etapa?", a: "volcanica", sol: "Hab√≠a gran actividad volc√°nica en el planeta primitivo" },
                { q: "¬øLa Tierra primitiva estaba caliente o fr√≠a?", a: "caliente", sol: "La Tierra era una masa de roca fundida muy caliente" },
                { q: "¬øHab√≠a ox√≠geno en la primera atm√≥sfera? (s√≠/no)", a: "no", sol: "NO hab√≠a ox√≠geno en la primera atm√≥sfera" }
            ],
            "1-1.2": [
                { q: "¬øQu√© gas se condens√≥ para formar los primeros oc√©anos?", a: "vapor agua", sol: "El vapor de agua se condens√≥ y precipit√≥ en forma de lluvias" },
                { q: "¬øC√≥mo se llama el conjunto de toda el agua del planeta?", a: "hidrosfera", sol: "La hidrosfera es el conjunto de toda el agua del planeta" },
                { q: "Las primeras lluvias dieron lugar a los _____ y _____", a: "mares oceanos", sol: "Las lluvias dieron lugar a los mares y oc√©anos" },
                { q: "¬øQu√© proceso f√≠sico transform√≥ el vapor en agua l√≠quida?", a: "condensacion", sol: "La condensaci√≥n transform√≥ el vapor en agua l√≠quida" },
                { q: "¬øHab√≠a ya ox√≠geno en esta etapa? (s√≠/no)", a: "no", sol: "Todav√≠a NO hab√≠a ox√≠geno en la atm√≥sfera" }
            ],
            "1-1.3": [
                { q: "¬øHace cu√°ntos millones de a√±os aparecieron las primeras bacterias fotosint√©ticas?", a: "3500", sol: "Hace 3500 millones de a√±os aparecieron las primeras bacterias fotosint√©ticas" },
                { q: "¬øQu√© gas incorporaron a la atm√≥sfera estos organismos?", a: "oxigeno", sol: "La fotos√≠ntesis incorpor√≥ ox√≠geno a la atm√≥sfera" },
                { q: "¬øQu√© nombre reciben las primeras bacterias fotosint√©ticas?", a: "cianobacterias", sol: "Se llamaban cianobacterias" },
                { q: "Adem√°s de bacterias, ¬øqu√© otros seres aumentaron el ox√≠geno?", a: "plantas algas", sol: "Las plantas y algas aumentaron el proceso fotosint√©tico" },
                { q: "¬øQu√© proceso biol√≥gico libera ox√≠geno?", a: "fotosintesis", sol: "La fotos√≠ntesis libera ox√≠geno a la atm√≥sfera" }
            ],
            "1-1.4": [
                { q: "¬øQu√© tipo de organismos pudieron aparecer gracias al ox√≠geno?", a: "animales", sol: "Pudieron aparecer los animales capaces de respirar ox√≠geno" },
                { q: "Desde que hay animales, ¬øla composici√≥n atmosf√©rica cambia mucho? (s√≠/no)", a: "no", sol: "La atm√≥sfera ha mantenido una composici√≥n pr√°cticamente constante" },
                { q: "¬øHasta qu√© √©poca podr√≠as viajar sin equipo especial para respirar?", a: "3500 millones", sol: "Desde hace unos 3500 millones de a√±os, cuando apareci√≥ el ox√≠geno" },
                { q: "¬øPor qu√© las plantas son importantes en la evoluci√≥n de la atm√≥sfera?", a: "producen oxigeno", sol: "Las plantas producen ox√≠geno mediante fotos√≠ntesis" },
                { q: "¬øQu√© respiramos los animales de la atm√≥sfera?", a: "oxigeno", sol: "Los animales respiran ox√≠geno" }
            ],
            "2-2.1": [
                { q: "¬øQu√© porcentaje del aire es nitr√≥geno?", a: "78", sol: "El nitr√≥geno representa el 78% del aire" },
                { q: "¬øQu√© porcentaje del aire es ox√≠geno?", a: "21", sol: "El ox√≠geno representa el 21% del aire" },
                { q: "¬øCu√°l es el gas m√°s abundante en la atm√≥sfera?", a: "nitrogeno", sol: "El nitr√≥geno es el gas m√°s abundante (78%)" },
                { q: "¬øQu√© gas necesitamos respirar?", a: "oxigeno", sol: "Necesitamos respirar ox√≠geno" },
                { q: "Entre nitr√≥geno y ox√≠geno, ¬øqu√© porcentaje del aire representan?", a: "99", sol: "Juntos representan el 99% del aire (78% + 21%)" }
            ],
            "2-2.2": [
                { q: "¬øQu√© porcentaje de CO‚ÇÇ hay en el aire?", a: "0.033", sol: "El CO‚ÇÇ representa el 0,033% del aire" },
                { q: "¬øQu√© gas absorben las plantas para hacer fotos√≠ntesis?", a: "dioxido carbono", sol: "Las plantas absorben di√≥xido de carbono (CO‚ÇÇ)" },
                { q: "¬øEl arg√≥n es un gas mayoritario o minoritario?", a: "minoritario", sol: "El arg√≥n es un gas minoritario en la atm√≥sfera" },
                { q: "Nombre tres gases minoritarios del aire", a: "argon vapor ozono", sol: "Arg√≥n, vapor de agua y ozono son gases minoritarios" },
                { q: "¬øEl CO‚ÇÇ es importante para el efecto invernadero? (s√≠/no)", a: "si", sol: "S√≠, el CO‚ÇÇ es un gas de efecto invernadero" }
            ],
            "2-2.3": [
                { q: "¬øEn qu√© estado se encuentra el agua en la atm√≥sfera?", a: "vapor", sol: "El agua est√° en forma de vapor en la atm√≥sfera" },
                { q: "¬øLas nubes son vapor de agua? (s√≠/no)", a: "no", sol: "NO, las nubes son gotas de agua l√≠quida o cristales de hielo" },
                { q: "¬øC√≥mo se llaman las part√≠culas s√≥lidas suspendidas en el aire?", a: "aerosoles", sol: "Se llaman aerosoles o part√≠culas en suspensi√≥n" },
                { q: "¬øEl polen es una part√≠cula en suspensi√≥n? (s√≠/no)", a: "si", sol: "S√≠, el polen es una part√≠cula en suspensi√≥n" },
                { q: "¬øEl polvo y el humo son part√≠culas en suspensi√≥n? (s√≠/no)", a: "si", sol: "S√≠, el polvo y el humo son part√≠culas en suspensi√≥n" }
            ],
            "2-2.4": [
                { q: "¬øLa atm√≥sfera es homog√©nea en todas sus capas? (s√≠/no)", a: "no", sol: "NO, la atm√≥sfera NO es homog√©nea; tiene distintas capas" },
                { q: "¬øCu√°ntas capas principales tiene la atm√≥sfera?", a: "5", sol: "La atm√≥sfera tiene 5 capas principales" },
                { q: "Suma los porcentajes de nitr√≥geno y ox√≠geno", a: "99", sol: "78% + 21% = 99%" },
                { q: "¬øQu√© nombre recibe la mezcla de gases que respiramos?", a: "aire", sol: "La mezcla de gases se llama aire" },
                { q: "¬øEl aire tiene masa? (s√≠/no)", a: "si", sol: "S√≠, el aire tiene masa y peso" }
            ],
            "3-3.1": [
                { q: "¬øCu√°l es la capa m√°s cercana a la superficie terrestre?", a: "troposfera", sol: "La troposfera es la capa m√°s cercana a la Tierra" },
                { q: "¬øHasta qu√© altura llega la troposfera? (en km)", a: "12", sol: "La troposfera llega hasta los 12 km de altura" },
                { q: "¬øQu√© porcentaje del aire est√° en la troposfera?", a: "80", sol: "La troposfera contiene el 80% del aire" },
                { q: "¬øD√≥nde ocurren las lluvias y tormentas?", a: "troposfera", sol: "Los fen√≥menos meteorol√≥gicos ocurren en la troposfera" },
                { q: "¬øLa temperatura en la troposfera aumenta o disminuye con la altura?", a: "disminuye", sol: "La temperatura disminuye con la altura en la troposfera" },
                { q: "¬øA qu√© temperatura puede llegar el l√≠mite superior de la troposfera?", a: "-70", sol: "Puede llegar a -70¬∞C en su l√≠mite superior" },
                { q: "¬øEn qu√© capa vuelan los aviones comerciales?", a: "troposfera", sol: "Los aviones comerciales vuelan en la troposfera" }
            ],
            "3-3.2": [
                { q: "¬øEntre qu√© alturas se encuentra la estratosfera? (km)", a: "12 50", sol: "La estratosfera est√° entre los 12 y 50 km de altura" },
                { q: "¬øQu√© capa protectora importante hay en la estratosfera?", a: "ozono", sol: "La capa de ozono est√° en la estratosfera" },
                { q: "¬øQu√© radiaci√≥n bloquea la capa de ozono?", a: "ultravioleta", sol: "La capa de ozono bloquea los rayos ultravioleta" },
                { q: "¬øLa temperatura en la estratosfera aumenta o disminuye con la altura?", a: "aumenta", sol: "La temperatura aumenta con la altura en la estratosfera" },
                { q: "¬øHasta qu√© temperatura puede llegar la estratosfera?", a: "0", sol: "Puede llegar hasta los 0¬∞C" },
                { q: "¬øPor qu√© aumenta la temperatura en la estratosfera?", a: "absorcion ultravioleta", sol: "Por la absorci√≥n de radiaci√≥n ultravioleta por el ozono" }
            ],
            "3-3.3": [
                { q: "¬øEntre qu√© alturas est√° la mesosfera? (km)", a: "50 80", sol: "La mesosfera est√° entre los 50 y 80 km" },
                { q: "¬øEs la mesosfera la capa m√°s fr√≠a o m√°s caliente?", a: "fria", sol: "La mesosfera es la capa M√ÅS FR√çA de la atm√≥sfera" },
                { q: "¬øQu√© temperatura m√≠nima alcanza la mesosfera?", a: "-100", sol: "Puede llegar a -100¬∞C" },
                { q: "¬øQu√© se desintegra en la mesosfera?", a: "meteoritos", sol: "Los meteoritos se desintegran en la mesosfera" },
                { q: "¬øC√≥mo se llaman las 'estrellas fugaces'?", a: "meteoritos", sol: "Son meteoritos que se desintegran en la mesosfera" },
                { q: "¬øEntre qu√© alturas est√° la termosfera? (km)", a: "80 500", sol: "La termosfera est√° entre los 80 y 500 km" },
                { q: "¬øQu√© temperatura puede alcanzar la termosfera?", a: "1500", sol: "Puede superar los 1.500¬∞C" },
                { q: "¬øQu√© fen√≥meno luminoso ocurre en la termosfera?", a: "auroras boreales", sol: "Las auroras boreales ocurren en la termosfera" }
            ],
            "3-3.4": [
                { q: "¬øCu√°l es la capa m√°s externa de la atm√≥sfera?", a: "exosfera", sol: "La exosfera es la capa m√°s externa" },
                { q: "¬øA qu√© altura comienza la exosfera? (km)", a: "600", sol: "La exosfera comienza alrededor de los 600 km" },
                { q: "¬øHasta d√≥nde se extiende la exosfera? (km)", a: "10000", sol: "Se extiende hasta los 10.000 km" },
                { q: "¬øQu√© tipo de sat√©lites est√°n en la exosfera?", a: "geoestacionarios", sol: "Los sat√©lites geoestacionarios est√°n en la exosfera" },
                { q: "¬øLa composici√≥n de la exosfera es igual al espacio? (s√≠/no)", a: "si", sol: "S√≠, su composici√≥n es igual al espacio interplanetario" },
                { q: "¬øD√≥nde orbita la Estaci√≥n Espacial Internacional?", a: "termosfera", sol: "La EEI orbita en la termosfera" },
                { q: "Ordena de cerca a lejos: exosfera, troposfera, estratosfera", a: "troposfera estratosfera exosfera", sol: "Troposfera, estratosfera, exosfera" }
            ],
            "4-4.1": [
                { q: "¬øQu√© fen√≥meno regula la temperatura de la Tierra?", a: "efecto invernadero", sol: "El efecto invernadero regula la temperatura" },
                { q: "¬øLos gases de efecto invernadero son buenos o malos?", a: "buenos", sol: "Son BUENOS, permiten la vida al mantener la temperatura" },
                { q: "Sin atm√≥sfera, ¬øla Tierra ser√≠a m√°s fr√≠a o m√°s caliente?", a: "fria", sol: "Sin atm√≥sfera la Tierra ser√≠a mucho m√°s fr√≠a" },
                { q: "¬øQu√© gas principal es responsable del efecto invernadero?", a: "dioxido carbono", sol: "El di√≥xido de carbono (CO‚ÇÇ) es el principal" },
                { q: "¬øLos invernaderos de agricultura usan el mismo principio? (s√≠/no)", a: "si", sol: "S√≠, atrapan el calor igual que la atm√≥sfera" }
            ],
            "4-4.2": [
                { q: "¬øQu√© capa filtra los rayos ultravioleta del Sol?", a: "ozono", sol: "La capa de ozono filtra los rayos ultravioleta" },
                { q: "¬øLos rayos UV son peligrosos para los seres vivos? (s√≠/no)", a: "si", sol: "S√≠, los rayos UV son peligrosos y pueden causar c√°ncer" },
                { q: "¬øEn qu√© capa atmosf√©rica se encuentra el ozono?", a: "estratosfera", sol: "El ozono est√° en la estratosfera" },
                { q: "¬øQu√© le pasar√≠a a la vida sin la capa de ozono?", a: "peligro radiacion", sol: "La radiaci√≥n UV da√±ar√≠a gravemente a los seres vivos" },
                { q: "¬øLa atm√≥sfera protege de meteoritos? (s√≠/no)", a: "si", sol: "S√≠, los meteoritos se desintegran en la mesosfera" }
            ],
            "4-4.3": [
                { q: "¬øQu√© gas necesitan los animales para respirar?", a: "oxigeno", sol: "Los animales necesitan ox√≠geno (O‚ÇÇ)" },
                { q: "¬øQu√© gas necesitan las plantas para la fotos√≠ntesis?", a: "dioxido carbono", sol: "Las plantas necesitan di√≥xido de carbono (CO‚ÇÇ)" },
                { q: "¬øQu√© gas protector hay en la estratosfera?", a: "ozono", sol: "El ozono (O‚ÇÉ) protege de los rayos UV" },
                { q: "¬øPuede haber vida sin atm√≥sfera? (s√≠/no)", a: "no", sol: "NO puede haber vida sin atm√≥sfera" },
                { q: "¬øLa atm√≥sfera contiene gases esenciales para la vida? (s√≠/no)", a: "si", sol: "S√≠, contiene O‚ÇÇ, CO‚ÇÇ y ozono, esenciales para la vida" }
            ],
            "4-4.4": [
                { q: "¬øD√≥nde ocurren las lluvias y tormentas?", a: "troposfera", sol: "Los fen√≥menos meteorol√≥gicos ocurren en la troposfera" },
                { q: "¬øLas lluvias nos dan agua dulce? (s√≠/no)", a: "si", sol: "S√≠, las lluvias nos proporcionan agua dulce" },
                { q: "¬øQu√© fen√≥meno meteorol√≥gico violento tiene vientos en espiral?", a: "tornado", sol: "Los tornados tienen vientos en espiral" },
                { q: "¬øLos huracanes son fen√≥menos meteorol√≥gicos? (s√≠/no)", a: "si", sol: "S√≠, los huracanes son fen√≥menos meteorol√≥gicos" },
                { q: "¬øEn qu√© capa est√°n las nubes?", a: "troposfera", sol: "Las nubes est√°n en la troposfera" }
            ],
            "5-5.1": [
                { q: "¬øQu√© es la contaminaci√≥n atmosf√©rica?", a: "sustancias nocivas", sol: "Presencia de sustancias nocivas en el aire" },
                { q: "Los √≥xidos de azufre, ¬øson contaminantes? (s√≠/no)", a: "si", sol: "S√≠, los √≥xidos de azufre son contaminantes" },
                { q: "Los √≥xidos de nitr√≥geno, ¬øson contaminantes? (s√≠/no)", a: "si", sol: "S√≠, los √≥xidos de nitr√≥geno son contaminantes" },
                { q: "¬øLos CFCs son contaminantes? (s√≠/no)", a: "si", sol: "S√≠, los CFCs destruyen la capa de ozono" },
                { q: "¬øEl exceso de CO‚ÇÇ es contaminaci√≥n? (s√≠/no)", a: "si", sol: "S√≠, el exceso de CO‚ÇÇ causa calentamiento global" },
                { q: "¬øLas part√≠culas s√≥lidas contaminan? (s√≠/no)", a: "si", sol: "S√≠, las part√≠culas s√≥lidas contaminan el aire" }
            ],
            "5-5.2": [
                { q: "¬øQu√© gases causan la lluvia √°cida?", a: "oxidos azufre nitrogeno", sol: "Los √≥xidos de azufre y nitr√≥geno causan lluvia √°cida" },
                { q: "¬øLa lluvia √°cida da√±a los bosques? (s√≠/no)", a: "si", sol: "S√≠, la lluvia √°cida da√±a los bosques y cultivos" },
                { q: "¬øLa lluvia √°cida afecta a los edificios? (s√≠/no)", a: "si", sol: "S√≠, corroe edificios y monumentos" },
                { q: "¬øDe d√≥nde proceden los √≥xidos que causan lluvia √°cida?", a: "combustion combustibles", sol: "De la combusti√≥n de combustibles f√≥siles" },
                { q: "¬øLa lluvia √°cida acidifica lagos y r√≠os? (s√≠/no)", a: "si", sol: "S√≠, acidifica lagos y r√≠os matando peces" }
            ],
            "5-5.3": [
                { q: "¬øQu√© es el smog?", a: "niebla contaminante", sol: "El smog es niebla contaminante con part√≠culas y gases" },
                { q: "¬øEl smog es m√°s com√∫n en ciudades o en el campo?", a: "ciudades", sol: "El smog es m√°s com√∫n en las ciudades" },
                { q: "¬øEl smog causa problemas respiratorios? (s√≠/no)", a: "si", sol: "S√≠, causa problemas respiratorios" },
                { q: "¬øLos coches contribuyen al smog? (s√≠/no)", a: "si", sol: "S√≠, los coches emiten gases contaminantes" },
                { q: "¬øQu√© tipo de energ√≠a NO contamina la atm√≥sfera?", a: "renovable", sol: "Las energ√≠as renovables NO contaminan" }
            ],
            "5-5.4": [
                { q: "¬øDebemos usar m√°s transporte p√∫blico para contaminar menos? (s√≠/no)", a: "si", sol: "S√≠, el transporte p√∫blico contamina menos" },
                { q: "¬øReciclar ayuda a reducir la contaminaci√≥n? (s√≠/no)", a: "si", sol: "S√≠, reciclar ayuda a reducir la contaminaci√≥n" },
                { q: "¬øAhorrar energ√≠a reduce la contaminaci√≥n? (s√≠/no)", a: "si", sol: "S√≠, ahorrar energ√≠a reduce la contaminaci√≥n" },
                { q: "¬øLas energ√≠as renovables contaminan? (s√≠/no)", a: "no", sol: "NO, las energ√≠as renovables no contaminan" },
                { q: "¬øPlantar √°rboles ayuda a limpiar el aire? (s√≠/no)", a: "si", sol: "S√≠, los √°rboles absorben CO‚ÇÇ y limpian el aire" },
                { q: "¬øNecesitamos acuerdos internacionales contra la contaminaci√≥n? (s√≠/no)", a: "si", sol: "S√≠, se necesitan acuerdos internacionales" }
            ],
            "6-6.1": [
                { q: "¬øEl efecto invernadero natural es bueno o malo?", a: "bueno", sol: "El efecto invernadero NATURAL es BUENO" },
                { q: "¬øQu√© pasar√≠a sin efecto invernadero?", a: "tierra fria", sol: "La Tierra ser√≠a demasiado fr√≠a para la vida" },
                { q: "¬øQu√© gases causan el efecto invernadero?", a: "co2 metano vapor", sol: "CO‚ÇÇ, metano y vapor de agua" },
                { q: "¬øLos gases invernadero atrapan calor? (s√≠/no)", a: "si", sol: "S√≠, atrapan el calor cerca de la superficie" },
                { q: "¬øEl efecto invernadero mantiene la temperatura agradable? (s√≠/no)", a: "si", sol: "S√≠, mantiene una temperatura agradable para la vida" }
            ],
            "6-6.2": [
                { q: "¬øEl calentamiento global es natural o causado por humanos?", a: "humanos", sol: "El calentamiento global actual es causado por humanos" },
                { q: "¬øQu√© causa el calentamiento global?", a: "exceso co2", sol: "El exceso de CO‚ÇÇ por quemar combustibles f√≥siles" },
                { q: "¬øEl calentamiento global derrite los polos? (s√≠/no)", a: "si", sol: "S√≠, el calentamiento global derrite los polos" },
                { q: "¬øQu√© actividades humanas aumentan el CO‚ÇÇ?", a: "quemar combustibles", sol: "Quemar combustibles f√≥siles (petr√≥leo, carb√≥n, gas)" },
                { q: "¬øEl nivel del mar sube con el calentamiento global? (s√≠/no)", a: "si", sol: "S√≠, el nivel del mar sube al derretirse el hielo" },
                { q: "¬øDebemos reducir las emisiones de CO‚ÇÇ? (s√≠/no)", a: "si", sol: "S√≠, debemos reducir las emisiones de CO‚ÇÇ" }
            ],
            "6-6.3": [
                { q: "¬øD√≥nde est√° la capa de ozono?", a: "estratosfera", sol: "La capa de ozono est√° en la estratosfera" },
                { q: "¬øQu√© radiaci√≥n bloquea la capa de ozono?", a: "ultravioleta", sol: "Bloquea los rayos ultravioleta (UV)" },
                { q: "¬øPara qu√© sirve la capa de ozono?", a: "proteger vida", sol: "Protege la vida de los rayos UV da√±inos" },
                { q: "¬øLos rayos UV causan c√°ncer de piel? (s√≠/no)", a: "si", sol: "S√≠, los rayos UV pueden causar c√°ncer de piel" },
                { q: "¬øEs importante proteger la capa de ozono? (s√≠/no)", a: "si", sol: "S√≠, es vital para proteger la vida" }
            ],
            "6-6.4": [
                { q: "¬øQu√© es el agujero de la capa de ozono?", a: "reduccion ozono", sol: "Es una reducci√≥n del ozono en ciertas zonas" },
                { q: "¬øQu√© gases destruyen la capa de ozono?", a: "cfcs", sol: "Los CFCs (clorofluorocarbonos)" },
                { q: "¬øD√≥nde est√° el agujero de ozono principal?", a: "antartida", sol: "Sobre la Ant√°rtida (Polo Sur)" },
                { q: "¬øLos CFCs se usaban en aerosoles y frigor√≠ficos? (s√≠/no)", a: "si", sol: "S√≠, se usaban en aerosoles y refrigerantes" },
                { q: "¬øEst√°n prohibidos los CFCs ahora? (s√≠/no)", a: "si", sol: "S√≠, est√°n prohibidos por acuerdos internacionales" },
                { q: "¬øLa capa de ozono se est√° recuperando? (s√≠/no)", a: "si", sol: "S√≠, lentamente se est√° recuperando" }
            ]
        };

        let state = {
            selectedBlock: null,
            selectedLevel: null,
            answers: {},
            showResults: {},
            studentName: localStorage.getItem('studentName_atmosfera') || '',
            showNameModal: !localStorage.getItem('studentName_atmosfera'),
            statistics: JSON.parse(localStorage.getItem('statistics_atmosfera') || '{}'),
            levelProgress: JSON.parse(localStorage.getItem('levelProgress_atmosfera') || '{}'),
            collectedWords: JSON.parse(localStorage.getItem('collectedWords_atmosfera') || '{}'),
            showWordModal: false,
            currentWord: null
        };

        function saveState() {
            localStorage.setItem('studentName_atmosfera', state.studentName);
            localStorage.setItem('statistics_atmosfera', JSON.stringify(state.statistics));
            localStorage.setItem('levelProgress_atmosfera', JSON.stringify(state.levelProgress));
            localStorage.setItem('collectedWords_atmosfera', JSON.stringify(state.collectedWords));
        }

        function checkAnswer(key, correct) {
            const userAnswer = (state.answers[key] || '').trim().toLowerCase().replace(/\s/g, '');
            const correctAnswer = correct.toLowerCase().replace(/\s/g, '');
            const isCorrect = userAnswer === correctAnswer;
            
            state.showResults[key] = isCorrect;
            const parts = key.split('-');
            const statKey = parts[0] + '-' + parts[1];
            
            if (!state.statistics[statKey]) {
                state.statistics[statKey] = { total: 0, correct: 0 };
            }
            if (!state.levelProgress[statKey]) {
                state.levelProgress[statKey] = {};
            }
            if (state.levelProgress[statKey][key] === undefined) {
                state.statistics[statKey].total++;
                if (isCorrect) state.statistics[statKey].correct++;
                state.levelProgress[statKey][key] = isCorrect;
            }

            saveState();
            checkLevelCompletion(statKey);
            render();
        }

        function checkLevelCompletion(statKey) {
            const exercises = exerciseData[statKey] || [];
            const totalExercises = exercises.length;
            const answeredExercises = Object.keys(state.levelProgress[statKey] || {}).length;
            
            if (answeredExercises === totalExercises && totalExercises > 0 && !state.collectedWords[statKey]) {
                const word = secretWords[statKey];
                state.collectedWords[statKey] = word;
                state.currentWord = word;
                state.showWordModal = true;
                saveState();
                render();
            }
        }

        function closeWordModal() {
            state.showWordModal = false;
            state.currentWord = null;
            render();
        }

        function copyWord(word) {
            navigator.clipboard.writeText(word).then(() => {
                showNotification('üìã Palabra copiada', 'La palabra "' + word + '" se ha copiado al portapapeles', 'success');
            }).catch(() => {
                showNotification('‚ö†Ô∏è No se pudo copiar', 'Copia la palabra manualmente', 'warning');
            });
        }

        function showNotification(title, message, type) {
            const bgColor = type === 'success' ? 'bg-green-50 border-green-300' : 'bg-yellow-50 border-yellow-300';
            const textColor = type === 'success' ? 'text-green-800' : 'text-yellow-800';
            
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 z-50 ' + bgColor + ' border-2 rounded-xl p-6 shadow-2xl max-w-md fade-in';
            notification.innerHTML = `
                <div class="flex items-start gap-3">
                    <div class="flex-1">
                        <h3 class="font-bold text-lg ${textColor} mb-2">${title}</h3>
                        <p class="${textColor} whitespace-pre-line">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="${textColor} hover:opacity-70 text-2xl">‚úï</button>
                </div>
            `;
            
            document.body.appendChild(notification);
            setTimeout(() => { if (notification.parentElement) notification.remove(); }, 5000);
        }

        function generateReport() {
            let totalExercises = 0;
            let totalCorrect = 0;
            let totalWords = Object.keys(state.collectedWords).length;
            let totalPossibleWords = Object.keys(secretWords).length;
            
            Object.entries(state.statistics).forEach(([key, stats]) => {
                totalExercises += stats.total;
                totalCorrect += stats.correct;
            });
            
            const overallPercentage = totalExercises > 0 ? ((totalCorrect / totalExercises) * 100).toFixed(1) : 0;
            return { totalExercises, totalCorrect, overallPercentage, totalWords, totalPossibleWords };
        }

        function getCompletedPhrase() {
            const orderedKeys = [
                "1-1.1", "1-1.2", "1-1.3", "1-1.4",
                "2-2.1", "2-2.2", "2-2.3", "2-2.4",
                "3-3.1", "3-3.2", "3-3.3", "3-3.4",
                "4-4.1", "4-4.2", "4-4.3", "4-4.4",
                "5-5.1", "5-5.2", "5-5.3", "5-5.4",
                "6-6.1", "6-6.2", "6-6.3", "6-6.4"
            ];
            
            const words = orderedKeys.map(key => state.collectedWords[key] || "____").join(" ");
            return words;
        }

        function render() {
            const app = document.getElementById('app');
            const report = generateReport();
            
            let html = '';

            if (state.showWordModal && state.currentWord) {
                html += `<div class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-lg w-full fade-in">
                        <div class="text-center">
                            <div class="text-6xl mb-4">üéâ</div>
                            <h2 class="text-3xl font-bold text-gray-800 mb-4">¬°Nivel Completado!</h2>
                            <p class="text-gray-600 mb-6">Has conseguido una palabra secreta:</p>
                            
                            <div class="secret-word word-reveal">
                                ${state.currentWord}
                            </div>
                            
                            <div class="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4 mb-6">
                                <p class="text-yellow-800 font-medium">
                                    üìù <strong>¬°IMPORTANTE!</strong> Anota esta palabra en tu hoja de recogida. La necesitar√°s para formar la frase final.
                                </p>
                            </div>
                            
                            <div class="flex gap-3 justify-center">
                                <button onclick="copyWord('${state.currentWord}')" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium shadow-lg">
                                    üìã Copiar Palabra
                                </button>
                                <button onclick="closeWordModal()" class="px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition font-medium shadow-lg">
                                    ‚úì Continuar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>`;
            }

            if (state.showNameModal && !state.studentName) {
                html += `<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full fade-in">
                        <div class="text-6xl text-center mb-4">üåç</div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">¬°Bienvenido a La Atm√≥sfera!</h2>
                        <p class="text-gray-600 mb-6 text-center">Por favor, introduce tu nombre para comenzar tu aventura:</p>
                        <input type="text" id="nameInput" placeholder="Tu nombre completo" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none mb-4">
                        <button onclick="setName()" class="w-full px-6 py-3 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-lg hover:from-blue-700 hover:to-cyan-700 transition font-medium shadow-lg">
                            üöÄ Comenzar Aventura
                        </button>
                    </div>
                </div>`;
            }

            html += `<div class="min-h-screen bg-gradient-to-br from-sky-100 via-blue-50 to-indigo-100 p-4">
                <div class="max-w-7xl mx-auto">
                    <div class="bg-gradient-to-r from-blue-600 to-cyan-600 rounded-2xl shadow-2xl p-8 mb-8 text-white relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-64 h-64 bg-white opacity-10 rounded-full -mr-32 -mt-32"></div>
                        <div class="absolute bottom-0 left-0 w-48 h-48 bg-white opacity-10 rounded-full -ml-24 -mb-24"></div>
                        
                        <div class="relative z-10">
                            <div class="flex items-center justify-between mb-4 flex-wrap gap-4">
                                <div class="flex items-center gap-4">
                                    <div class="bg-white p-4 rounded-xl shadow-lg">
                                        <span class="text-5xl">üåç</span>
                                    </div>
                                    <div>
                                        <h1 class="text-4xl font-bold mb-2">La Atm√≥sfera</h1>
                                        <p class="text-blue-100 text-lg">Biolog√≠a y Geolog√≠a - 1¬∫ ESO üå§Ô∏è</p>
                                        ${state.studentName ? `<p class="text-blue-200 text-sm mt-1 font-medium">üë§ ${state.studentName}</p>` : ''}
                                    </div>
                                </div>
                                ${report.totalWords > 0 ? `<button onclick="showWordsModal()" class="bg-purple-600 text-white px-6 py-3 rounded-xl hover:bg-purple-700 transition shadow-lg font-medium">
                                    üî§ Mis Palabras (${report.totalWords}/${report.totalPossibleWords})
                                </button>` : ''}
                            </div>
                            
                            <div class="flex gap-4 mt-6 flex-wrap">
                                <div class="bg-white bg-opacity-20 px-4 py-2 rounded-lg backdrop-blur"><span class="font-semibold">üéØ 6 Bloques Tem√°ticos</span></div>
                                <div class="bg-white bg-opacity-20 px-4 py-2 rounded-lg backdrop-blur"><span class="font-semibold">üìö 24 Niveles</span></div>
                                <div class="bg-white bg-opacity-20 px-4 py-2 rounded-lg backdrop-blur"><span class="font-semibold">‚úçÔ∏è +120 Ejercicios</span></div>
                                ${Object.keys(state.statistics).length > 0 ? `<div class="bg-green-400 bg-opacity-90 px-4 py-2 rounded-lg backdrop-blur"><span class="font-semibold">‚úÖ ${report.totalCorrect}/${report.totalExercises} correctos</span></div>` : ''}
                                ${report.totalWords > 0 ? `<div class="bg-purple-400 bg-opacity-90 px-4 py-2 rounded-lg backdrop-blur"><span class="font-semibold">üî§ ${report.totalWords}/${report.totalPossibleWords} palabras</span></div>` : ''}
                            </div>
                            
                            ${state.selectedLevel ? `<div class="mt-4 bg-yellow-300 bg-opacity-90 px-4 py-2 rounded-lg backdrop-blur"><span class="font-semibold text-gray-800">üéÅ Al completar este nivel recibir√°s una palabra secreta</span></div>` : ''}
                        </div>
                    </div>
                    ${!state.selectedBlock ? renderBlockSelection() : (!state.selectedLevel ? renderLevelSelection() : renderExercises())}
                </div>
            </div>`;

            app.innerHTML = html;
        }

        function showWordsModal() {
            const orderedKeys = [
                "1-1.1", "1-1.2", "1-1.3", "1-1.4",
                "2-2.1", "2-2.2", "2-2.3", "2-2.4",
                "3-3.1", "3-3.2", "3-3.3", "3-3.4",
                "4-4.1", "4-4.2", "4-4.3", "4-4.4",
                "5-5.1", "5-5.2", "5-5.3", "5-5.4",
                "6-6.1", "6-6.2", "6-6.3", "6-6.4"
            ];
            
            let modalHTML = `<div class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4" onclick="this.remove()">
                <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto fade-in" onclick="event.stopPropagation()">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-3xl font-bold text-gray-800 flex items-center gap-3">
                            <span class="text-4xl">üî§</span> Mis Palabras Secretas
                        </h2>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-gray-500 hover:text-gray-700 text-3xl">‚úï</button>
                    </div>
                    
                    <div class="bg-purple-50 border-2 border-purple-300 rounded-lg p-6 mb-6">
                        <h3 class="font-bold text-lg text-purple-900 mb-3">üìù Frase Completa:</h3>
                        <p class="text-xl font-medium text-purple-800 leading-relaxed">
                            ${getCompletedPhrase()}
                        </p>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-4 mb-6">
                        ${orderedKeys.map((key, index) => {
                            const word = state.collectedWords[key];
                            const parts = key.split('-');
                            const blockId = parts[0];
                            const levelId = parts[1];
                            const blockName = blocks[blockId]?.title || 'Bloque ' + blockId;
                            const levelName = levelNames[blockId]?.[levelId] || 'Nivel ' + levelId;
                            
                            return `<div class="border-2 ${word ? 'border-green-300 bg-green-50' : 'border-gray-200 bg-gray-50'} rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div class="flex-1">
                                        <div class="text-sm text-gray-600 mb-1">Nivel ${levelId}</div>
                                        <div class="text-xs text-gray-500">${blockName}</div>
                                    </div>
                                    <div class="text-right">
                                        ${word ? `<div class="text-2xl font-bold text-green-700">${word}</div>` : `<div class="text-gray-400">üîí Bloqueada</div>`}
                                    </div>
                                </div>
                            </div>`;
                        }).join('')}
                    </div>
                    
                    <div class="flex gap-3 justify-center">
                        <button onclick="copyPhrase()" class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition font-medium shadow-lg">
                            üìã Copiar Frase Completa
                        </button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition font-medium shadow-lg">
                            Cerrar
                        </button>
                    </div>
                </div>
            </div>`;
            
            const modalDiv = document.createElement('div');
            modalDiv.innerHTML = modalHTML;
            document.body.appendChild(modalDiv.firstElementChild);
        }

        function copyPhrase() {
            const phrase = getCompletedPhrase();
            navigator.clipboard.writeText(phrase).then(() => {
                showNotification('üìã Frase copiada', 'La frase completa se ha copiado al portapapeles', 'success');
            }).catch(() => {
                showNotification('‚ö†Ô∏è No se pudo copiar', 'Copia la frase manualmente', 'warning');
            });
        }

        function renderBlockSelection() {
            return `<div class="fade-in">
                <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3">
                    <span class="text-4xl">üéì</span> 
                    Selecciona un Bloque Tem√°tico
                </h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    ${Object.entries(blocks).map(([id, block]) => {
                        const completedLevels = Object.keys(levelNames[id] || {}).filter(levelId => {
                            const statKey = id + '-' + levelId;
                            return state.collectedWords[statKey];
                        }).length;
                        const totalLevels = Object.keys(levelNames[id] || {}).length;
                        
                        return `<div onclick="selectBlock('${id}')" class="bg-white rounded-2xl shadow-xl overflow-hidden cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-2xl">
                            <img src="${block.image}" alt="${block.title}" class="block-image" onerror="this.style.display='none'">
                            <div class="p-6 bg-gradient-to-br ${block.color}">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="text-6xl">${block.icon}</div>
                                    ${completedLevels > 0 ? `<span class="bg-white bg-opacity-30 backdrop-blur px-3 py-1 rounded-full text-sm font-bold text-white">
                                        üî§ ${completedLevels}/${totalLevels}
                                    </span>` : ''}
                                </div>
                                
                                <h3 class="font-bold text-xl mb-2 leading-tight text-white">${block.title}</h3>
                                <p class="text-white text-opacity-90 text-sm mb-4">${block.desc}</p>
                                
                                <div class="mt-4 flex items-center text-white font-medium">
                                    Explorar <span class="ml-2 text-2xl">‚Üí</span>
                                </div>
                            </div>
                        </div>`;
                    }).join('')}
                </div>
            </div>`;
        }

        function renderLevelSelection() {
            const block = blocks[state.selectedBlock];
            return `<div class="fade-in">
                <button onclick="backToBlocks()" class="mb-6 px-6 py-3 bg-white rounded-xl hover:bg-gray-50 transition shadow-lg flex items-center gap-2 font-medium">
                    <span class="text-xl">‚Üê</span> Volver a Bloques
                </button>
                
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden mb-8">
                    <img src="${block.image}" alt="${block.title}" class="w-full h-64 object-cover" onerror="this.style.display='none'">
                    <div class="bg-gradient-to-r ${block.color} p-8 text-white">
                        <div class="flex items-center gap-4 flex-wrap">
                            <div class="text-7xl">${block.icon}</div>
                            <div class="flex-1">
                                <h2 class="text-3xl font-bold mb-2">${block.title}</h2>
                                <p class="text-white text-opacity-90 text-lg">${block.desc}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 gap-6">
                    ${Object.entries(levelNames[state.selectedBlock] || {}).map(([levelId, levelName]) => {
                        const statKey = state.selectedBlock + '-' + levelId;
                        const stats = state.statistics[statKey];
                        const hasStats = stats && stats.total > 0;
                        const hasWord = state.collectedWords[statKey];
                        const word = secretWords[statKey];
                        const levelImage = levelImages[statKey];
                        const isComplete = hasStats && stats.correct === stats.total;
                        const percentage = hasStats ? ((stats.correct / stats.total) * 100).toFixed(0) : 0;
                        
                        return `<div onclick="selectLevel('${levelId}')" class="bg-white rounded-xl shadow-lg overflow-hidden cursor-pointer hover:shadow-2xl transition-all transform hover:scale-105 border-2 ${hasWord ? 'border-purple-400' : 'border-transparent'}">
                            ${levelImage ? `<img src="${levelImage}" alt="${levelName}" class="level-image" onerror="this.style.display='none'">` : ''}
                            <div class="p-6">
                                <div class="flex items-center justify-between mb-3">
                                    <span class="bg-gradient-to-r from-blue-400 to-cyan-500 text-white px-4 py-1 rounded-full text-sm font-bold">
                                        Nivel ${levelId}
                                    </span>
                                    ${hasWord ? `<div class="bg-purple-100 px-3 py-1 rounded-full">
                                        <span class="text-purple-700 font-bold text-sm">üî§ ${word}</span>
                                    </div>` : `<div class="text-gray-400 text-sm">üîí Sin palabra</div>`}
                                </div>
                                <h3 class="font-bold text-xl text-gray-800 mb-2">${levelName}</h3>
                                ${hasStats ? `<div class="text-sm text-gray-600">
                                    ‚úì ${stats.correct}/${stats.total} correctos (${percentage}%)
                                </div>` : ''}
                                <div class="flex items-center text-blue-600 font-medium mt-3">
                                    ${hasStats ? 'Repasar' : 'Comenzar'} <span class="ml-2">‚Üí</span>
                                </div>
                            </div>
                        </div>`;
                    }).join('')}
                </div>
            </div>`;
        }

        function renderExercises() {
            const exercises = exerciseData[state.selectedBlock + '-' + state.selectedLevel] || [];
            const statKey = state.selectedBlock + '-' + state.selectedLevel;
            const stats = state.statistics[statKey] || { total: 0, correct: 0 };
            const block = blocks[state.selectedBlock];
            const levelImage = levelImages[statKey];
            const percentage = stats.total > 0 ? ((stats.correct / stats.total) * 100).toFixed(0) : 0;
            const hasWord = state.collectedWords[statKey];
            const word = secretWords[statKey];
            
            return `